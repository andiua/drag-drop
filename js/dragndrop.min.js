(()=>{"use strict";class t{constructor(t){let{dragElement:e,dropElement:o,dropEveryWhere:i=!1,dropFewInOne:n=!1,dropIntoCenter:r=!1,enableDropped:s=!1,transition:d="transform 0.4s ease-in-out",afterDroped:a}=t;e?(this.dragElement=document.querySelectorAll(e),o&&(this.dropElement=document.querySelectorAll(o)),this.options={dropEveryWhere:i,dropFewInOne:n,dropIntoCenter:r,transition:d,enableDropped:s},this.afterDroped=a,this.transitionTime=()=>{const t=d.match(/(\d+.\d+s |.\d+s | \d+s | \d+ms)/g)[0];return t.includes("ms")?t.slice(1,-2)<100?(console.warn("drag&drop: Check transition-time. The smallest time is 100ms"),100):t.slice(1,-2):1e3*t.slice(0,-2)<100?(console.warn("drag&drop: Check transition-time. The smallest time is 0.1s"),100):1e3*t.slice(0,-2)},this.eventCoordinates={},this.eventStartCoordinates=[],this.dragCoordinates={},this.dropCoordinates=[],this.boundDragDown=[],this.boundDragMove,this.boundDragUp):console.warn('drag&drop: Need 1 propertie "dragElement"')}init(){this.dragElement.forEach(((t,e)=>{this.boundDragDown[e]=this.dragDown.bind(this,t),t.addEventListener("pointerdown",this.boundDragDown[e])}))}addDropCoordinates(){this.dropCoordinates=[],this.dropElement.forEach((t=>{const e=t.getBoundingClientRect(),o={top:e.top,left:e.left,bottom:e.bottom,right:e.right,width:e.width,height:e.height};this.dropCoordinates.push(o)}))}dropItem(t,e,o){const i=t.getBoundingClientRect(),n=t.style.transform.match(/(-\d+|\d+)/g);let r,s;if(this.options.dropIntoCenter){let o=(i.width-e.width)/2,d=(i.height-e.height)/2;r=e.left-o-i.left+Number(n[0]),s=e.top-d-i.top+Number(n[1]),t.style.cssText=`\n\t\t\t\t\ttransition: ${this.options.transition};\n\t\t\t\t\ttransform: translate(${r}px, ${s}px)`,setTimeout((()=>{t.style.transition=""}),this.transitionTime())}this.options.enableDropped||this.dragElement.forEach(((e,o)=>{e===t&&(t.removeEventListener("pointerdown",this.boundDragDown[o]),t.style.cursor="auto")})),this.afterDroped&&this.afterDroped(),t.classList.add("dropped"),t.classList.remove("droppable")}checkCoincidence(t,e){const o=t.getBoundingClientRect();return this.dropCoordinates.some(((i,n)=>i.top<=o.top+o.height/2&&i.left<=o.left+o.width/2&&i.bottom>=o.bottom-o.height/2&&i.right>=o.right-o.width/2?(t.classList.add("droppable"),this.dropElement[n].classList.add("droppable__hover"),"pointermove"!==e.type&&this.dropItem(t,i,e),!0):(t.classList.remove("droppable"),this.dropElement[n].classList.remove("droppable__hover"),!1)))}addBasicCoordinates(t,e){const o=e.getBoundingClientRect();this.dragCoordinates={top:o.top,left:o.left,bottom:o.bottom,right:o.right},this.dragElement.forEach(((o,i)=>{const n=o===e;if(!this.eventStartCoordinates[i]&&n||!this.options.dropEveryWhere&&n&&!e.classList.contains("dropped"))console.log("object"),this.eventStartCoordinates[i]={left:t.clientX,top:t.clientY};else if(this.eventStartCoordinates[i]&&e.style.transform||this.options.enableDropped&&n&&e.classList.contains("dropped")){const o=e.style.transform.match(/(-\d+|\d+)/g);this.eventStartCoordinates[i]={left:t.clientX-Number(o[0]),top:t.clientY-Number(o[1])}}e.classList.remove("dropped")}))}changeDragCoordinates(t,e){this.eventCoordinates={left:t.clientX,top:t.clientY},this.dragElement.forEach(((t,o)=>{if(t===e){let t=this.eventCoordinates.left-this.eventStartCoordinates[o].left,i=this.eventCoordinates.top-this.eventStartCoordinates[o].top;e.style.cssText=`\n\t\t\t\t\ttransform: translate(${t}px, ${i}px);\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tz-index: 9999;\n\t\t\t\t\t`}}))}addFinishCoordinates(t,e){this.checkCoincidence(t,e)||this.options.dropEveryWhere||(t.style.transition=this.options.transition,t.style.transform="",setTimeout((()=>{t.style.transition=""}),this.transitionTime())),t.style.position="",t.style.zIndex=""}dragDown(t,e){this.boundDragMove=this.dragMove.bind(this,t),this.boundDragUp=this.dragUp.bind(this,t),document.body.addEventListener("pointermove",this.boundDragMove),document.body.addEventListener("pointerup",this.boundDragUp),this.dropElement&&this.addDropCoordinates(),this.addBasicCoordinates(e,t),this.changeDragCoordinates(e,t),t.classList.add("dragging")}dragMove(t,e){e.preventDefault(),t.style.cursor="grabbing",this.changeDragCoordinates(e,t),this.checkCoincidence(t,e)}dragUp(t,e){t.classList.remove("dragging"),document.body.removeEventListener("pointermove",this.boundDragMove),document.body.removeEventListener("pointerup",this.boundDragUp),t.style.cursor="",this.addFinishCoordinates(t,e)}}window.addEventListener("DOMContentLoaded",(()=>{new t({dragElement:".elemImg:not([data-drag])"}).init(),new t({dragElement:'[data-drag="2"]',dropElement:'[data-drop="2"]',dropEveryWhere:!0}).init(),new t({dragElement:'[data-drag="1"]',dropElement:'[data-drop="1"]',dropIntoCenter:!0,enableDropped:!0}).init()}))})();
//# sourceMappingURL=dragndrop.min.js.map